(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{413:function(e,t,o){"use strict";var r=o(0).a.extend({data:function(){return{version:"1.0.13"}}}),n=o(77),l=o(125),c=o.n(l),d=o(483),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-footer",{attrs:{color:e.$colors.indigo.darken1,absolute:"",app:"",height:"24",padless:""}},[o("div",{staticClass:"mx-auto my-auto"},[o("span",{staticClass:"white--text",style:{fontSize:"12px"}},[e._v("\n      sapporo-web "+e._s(e.version)+" Â© Bioinformation and DDBJ Center\n    ")])])])}),[],!1,null,null,null);t.a=component.exports;c()(component,{VFooter:d.a})},420:function(e,t,o){e.exports=o.p+"img/cwl-icon.d6a463e.png"},421:function(e,t,o){e.exports=o.p+"img/wdl-icon.3954ce4.png"},422:function(e,t,o){e.exports=o.p+"img/nextflow-icon.5351591.png"},423:function(e,t,o){e.exports=o.p+"img/snakemake-icon.b8289bc.png"},428:function(e,t,o){"use strict";o(29),o(15),o(63),o(76),o(40);var r={data:function(){return{type:"",id:""}},computed:{items:function(){var e=[{text:"Home",nuxt:!0,to:"/",icon:"mdi-home-outline"}];if("service"===this.type){var t=this.$store.getters["services/service"](this.id);t&&e.push({text:t.name,nuxt:!0,to:"/services?serviceId=".concat(t.id),icon:"mdi-dns-outline"})}else if("workflow"===this.type){var o=this.$store.getters["workflows/workflow"](this.id);if(o){var r=this.$store.getters["services/service"](o.serviceId);r&&e.push({text:r.name,nuxt:!0,to:"/services?serviceId=".concat(r.id),icon:"mdi-dns-outline"}),e.push({text:o.name,nuxt:!0,to:"/workflows?workflowId=".concat(o.id),icon:"mdi-graph-outline"})}}else if("run"===this.type){var n=this.$store.getters["runs/run"](this.id);if(n){var l=this.$store.getters["workflows/workflow"](n.workflowId);if(l){var c=this.$store.getters["services/service"](n.serviceId);c&&e.push({text:c.name,nuxt:!0,to:"/services?serviceId=".concat(c.id),icon:"mdi-dns-outline"}),e.push({text:l.name,nuxt:!0,to:"/workflows?workflowId=".concat(l.id),icon:"mdi-graph-outline"})}e.push({text:n.name,nuxt:!0,to:"/runs?runId=".concat(n.id),icon:"mdi-chart-box-outline"})}}return e}},created:function(){for(var e=this.$route.query,t=0,o=Object.keys(e);t<o.length;t++){var r=o[t];if(r.includes("Id")){this.type=r.slice(0,-2);var n=e[r]||"";Array.isArray(n)&&(n=n[0]||""),this.id=n;break}}}},n=o(0).a.extend(r),l=o(77),c=o(125),d=o.n(c),f=o(599),m=o(486),v=o(399),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-breadcrumbs",{staticClass:"pt-2",attrs:{items:e.items,large:""},scopedSlots:e._u([{key:"divider",fn:function(){return[o("v-icon",{domProps:{textContent:e._s("mdi-chevron-right")}})]},proxy:!0},{key:"item",fn:function(t){var r=t.item;return[o("v-breadcrumbs-item",{attrs:{nuxt:r.nuxt,to:r.to}},[o("v-icon",{attrs:{color:e.$colors.grey.darken2,left:""},domProps:{textContent:e._s(r.icon)}}),e._v(" "),o("span",{domProps:{textContent:e._s(r.text)}})],1)]}}])})}),[],!1,null,null,null);t.a=component.exports;d()(component,{VBreadcrumbs:f.a,VBreadcrumbsItem:m.a,VIcon:v.a})},472:function(e,t,o){var content=o(561);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(33).default)("604908a2",content,!0,{sourceMap:!1})},473:function(e,t,o){var content=o(563);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(33).default)("7e61cbd0",content,!0,{sourceMap:!1})},474:function(e,t,o){var content=o(565);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(33).default)("907c8184",content,!0,{sourceMap:!1})},475:function(e,t,o){var content=o(567);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(33).default)("5c6fa101",content,!0,{sourceMap:!1})},476:function(e,t,o){var content=o(574);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(33).default)("5da074a2",content,!0,{sourceMap:!1})},560:function(e,t,o){"use strict";o(472)},561:function(e,t,o){var r=o(32)(!1);r.push([e.i,'.content-viewer[data-v-5d75855d] .CodeMirror{height:250px!important;font-size:.9rem!important}.content-viewer[data-v-5d75855d] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}.info-table[data-v-5d75855d] td:first-child{width:270px;font-weight:500}.info-table[data-v-5d75855d] tr:not(:last-child) td{border-bottom:none!important}',""]),e.exports=r},562:function(e,t,o){"use strict";o(473)},563:function(e,t,o){var r=o(32)(!1);r.push([e.i,'.content-viewer[data-v-8166adb2] .CodeMirror{height:200px!important;font-size:.9rem!important}.content-viewer[data-v-8166adb2] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}',""]),e.exports=r},564:function(e,t,o){"use strict";o(474)},565:function(e,t,o){var r=o(32)(!1);r.push([e.i,".run-table[data-v-77921992] td:first-child{padding-right:0}",""]),e.exports=r},566:function(e,t,o){"use strict";o(475)},567:function(e,t,o){var r=o(32)(!1);r.push([e.i,'.content-viewer[data-v-e04e3864] .CodeMirror{height:300px!important;font-size:.9rem!important}.content-viewer[data-v-e04e3864] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}.content-viewer[data-v-e04e3864] .CodeMirror-gutter-wrapper{left:-30px!important}',""]),e.exports=r},573:function(e,t,o){"use strict";o(476)},574:function(e,t,o){var r=o(32)(!1);r.push([e.i,".workflow-table[data-v-6b060a16] td:first-child{padding-right:0}",""]),e.exports=r},591:function(e,t,o){"use strict";o.r(t);var r=o(5),n=(o(63),o(76),o(55),o(0)),l=o(199),c=o(413),d=o(428),f=(o(424),o(425),o(426),o(427)),m=o(71),v={components:{codemirror:f.codemirror},props:{serviceId:{type:String,required:!0}},data:function(){return{serviceInfoHeaders:[{text:"Key",value:"key"},{text:"Value",value:"value"}],tab:1}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},serviceInfoContents:function(){return[{key:"Service Endpoint",value:this.service.endpoint},{key:"Added Date",value:this.$dayjs(this.service.addedDate).local().format("YYYY-MM-DD HH:mm:ss")}]},tabItems:function(){var e,t,o,r,n,l,c,d,f,m,v,w;return[{key:"Workflow Type Versions",value:JSON.stringify((null===(t=null===(e=this.service)||void 0===e?void 0:e.serviceInfo)||void 0===t?void 0:t.workflow_type_versions)||"",null,2)},{key:"Workflow Engine Versions",value:JSON.stringify((null===(r=null===(o=this.service)||void 0===o?void 0:o.serviceInfo)||void 0===r?void 0:r.workflow_engine_versions)||"",null,2)},{key:"Default Workflow Engine Parameters",value:JSON.stringify((null===(l=null===(n=this.service)||void 0===n?void 0:n.serviceInfo)||void 0===l?void 0:l.default_workflow_engine_parameters)||"",null,2)},{key:"Supported Filesystem Protocols",value:JSON.stringify((null===(d=null===(c=this.service)||void 0===c?void 0:c.serviceInfo)||void 0===d?void 0:d.supported_filesystem_protocols)||(null===(m=null===(f=this.service)||void 0===f?void 0:f.serviceInfo)||void 0===m?void 0:m.supported_file_system_protocols)||"",null,2)},{key:"Tags",value:JSON.stringify((null===(w=null===(v=this.service)||void 0===v?void 0:v.serviceInfo)||void 0===w?void 0:w.tags)||"",null,2)}]}},methods:{reloadService:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("services/updateService",e.serviceId);case 2:case"end":return t.stop()}}),t)})))()},codeMirrorMode:function(content){return Object(m.a)(content)},validUrl:function(e){return Object(m.e)(e)}},filters:{jsonStringfy:function(e){return JSON.stringify(e)}}},w=n.a.extend(v),h=(o(560),o(77)),y=o(125),k=o.n(y),x=o(400),_=o(407),C=o(461),I=o(595),T=o(399),S=o(405),N=o(589),R=o(600),P=o(597),V=o(590),component=Object(h.a)(w,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.service?o("v-card",{ref:"card",attrs:{"max-width":"1200"}},[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-dns-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s(e.service.name)}}),e._v(" "),e.service.preRegistered?o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-icon",e._g({staticClass:"ml-2 mt-1",attrs:{color:e.$colors.indigo.darken1},domProps:{textContent:e._s("mdi-account-check-outline")}},r))]}}],null,!1,3490612083)},[e._v(" "),o("span",{domProps:{textContent:e._s("Pre-registered WES service")}})]):e._e(),e._v(" "),o("v-spacer"),e._v(" "),o("v-chip",{staticClass:"mr-4",attrs:{color:e.$store.getters["services/stateColor"](e.service.id),"text-color":"white"},domProps:{textContent:e._s(e.service.state)}}),e._v(" "),o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-btn",e._g({attrs:{color:e.$colors.grey.darken2,outlined:"",small:""},on:{click:function(t){return t.stopPropagation(),e.reloadService.apply(null,arguments)}}},r),[o("v-icon",{domProps:{textContent:e._s("mdi-reload")}})],1)]}}],null,!1,781684642)},[e._v(" "),o("span",{domProps:{textContent:e._s("Reload WES service")}})])],1),e._v(" "),o("v-data-table",{staticClass:"mx-12 mt-2 info-table",attrs:{headers:e.serviceInfoHeaders,items:e.serviceInfoContents,"calculate-widths":"","disable-filtering":"","disable-pagination":"","disable-sort":"","hide-default-footer":"","hide-default-header":"","item-key":"key"},scopedSlots:e._u([{key:"item.value",fn:function(t){var r=t.item;return[o("span",{domProps:{textContent:e._s(r.value)}})]}}],null,!0)}),e._v(" "),o("div",{staticClass:"mx-12"},[o("v-tabs",{attrs:{vertical:"",height:"282"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[e._l(e.tabItems,(function(t){return o("v-tab",{key:t.key,style:{textTransform:"none",justifyContent:"start",letterSpacing:"normal"},domProps:{textContent:e._s(t.key)}})})),e._v(" "),e._l(e.tabItems,(function(t){return o("v-tab-item",{key:t.key},[o("codemirror",{ref:"codeMirror",refInFor:!0,staticClass:"ml-6 mr-1 mt-2 mb-6 elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,mode:e.codeMirrorMode(t.value),readOnly:"nocursor",tabSize:2},value:t.value}})],1)}))],2)],1)],1):e._e()}),[],!1,null,"5d75855d",null),$=component.exports;k()(component,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VIcon:T.a,VSpacer:S.a,VTab:N.a,VTabItem:R.a,VTabs:P.a,VTooltip:V.a});o(14),o(52),o(35),o(11),o(202),o(203),o(204),o(205),o(206),o(207),o(208),o(209),o(210),o(211),o(212),o(213),o(214),o(215),o(216),o(217),o(218),o(41),o(51);var W={props:{dialogShow:{type:Boolean,default:!1,required:!0},selectedItems:{type:Array,default:[],required:!0}},methods:{deleteSelectedItems:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("runs/deleteRuns",e.selectedItems.map((function(e){return e.runId})));case 2:e.$emit("close");case 3:case"end":return t.stop()}}),t)})))()}}},D=n.a.extend(W),O=o(583),M=Object(h.a)(D,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"600"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Remove Run")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("The following run will be removed:")}}),e._v(" "),o("ul",{style:{paddingLeft:"96px",paddingRight:"96px"}},e._l(e.selectedItems,(function(t,i){return o("li",{key:i,domProps:{textContent:e._s(t.runName)}})})),0),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 mt-4 pb-6"},[o("v-btn",{attrs:{color:"error",outlined:""},on:{click:function(t){return t.stopPropagation(),e.deleteSelectedItems.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Remove")}})],1),e._v(" "),o("v-btn",{staticClass:"ml-4",attrs:{color:"info",outlined:""},on:{click:function(t){return t.stopPropagation(),e.$emit("close")}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-close")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Cancel")}})],1)],1)])],1)}),[],!1,null,null,null),j=M.exports;k()(M,{VBtn:x.a,VCard:_.a,VDialog:O.a,VIcon:T.a});o(78),o(24),o(58),o(20),o(19),o(29),o(40),o(9),o(46),o(57);var E=o(61);function A(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var U=[],L={components:{codemirror:f.codemirror},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{runId:"",getFailed:!0,runLog:void 0,runName:"",workflowName:"",workflowType:"",workflowVersion:"",workflowUrl:"",workflowContent:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},workflows:function(){return this.$store.getters["workflows/workflowsByIds"](this.service.workflowIds)},runIdRules:function(){return this.runId?this.service.runIds.includes(this.runId)?["The Run ID already exists"]:this.getFailed?["The Run ID does not exist in this WES service"]:[]:["Required"]},formValid:function(){return!this.runIdRules.length}},methods:{changeRunId:function(){for(var e=this;U.length;){var t=U.shift();t&&clearTimeout(t)}var o=setTimeout((function(t){e.getRunsId(t)}),1e3,this.runId);U.push(o)},getRunsId:function(e){var t=this;this.service.runIds.includes(this.runId)||Object(E.b)(this.service.endpoint,e).then((function(o){var r;t.getFailed=!1,t.runLog=o,t.workflowName=o.request.workflow_name||o.request.workflow_url.split("/").pop()||e;var n=t.service.serviceInfo.supported_wes_versions.includes("sapporo-wes-1.0.0")?o.run_log.start_time:null===(r=o.run_log)||void 0===r?void 0:r.task_started,l=n?t.$dayjs(n):t.$dayjs();if(t.runName="".concat(t.workflowName," ").concat(l.local().format("YYYY-MM-DD HH:mm:ss")),t.workflowType=o.request.workflow_type,t.workflowVersion=o.request.workflow_type_version,t.workflowUrl=o.request.workflow_url,t.workflowContent="Failed to get workflow content",Object(m.e)(t.workflowUrl))Object(m.b)(t.workflowUrl).then((function(e){t.workflowUrl=e,fetch(t.workflowUrl).then((function(e){if(!e.ok)throw new Error(e.statusText);e.text().then((function(text){return t.workflowContent=text}))}))}));else{var c,d=t.workflowUrl.split("/").pop()||"",f=A(o.request.workflow_attachment||[]);try{for(f.s();!(c=f.n()).done;){var v=c.value;if(d===(v.file_name.split("/").pop()||"")){fetch(v.file_url).then((function(e){if(!e.ok)throw new Error(e.statusText);e.text().then((function(text){return t.workflowContent=text}))}));break}}}catch(e){f.e(e)}finally{f.f()}}})).catch((function(e){t.getFailed=!0,t.runLog=void 0,t.runName="",t.workflowName="",t.workflowType="",t.workflowVersion="",t.workflowUrl="",t.workflowContent=""}))},codeMirrorMode:function(content){return Object(m.a)(content)},importRun:function(){var e,t,o=this;if(this.formValid){var r=null;this.workflows.forEach((function(e){e.name===o.workflowName&&(r=e.id)})),r?this.$store.dispatch("runs/addRun",{serviceId:this.serviceId,workflowId:r,runId:this.runId,runName:this.runName,runLog:this.runLog}):this.$store.dispatch("workflows/addWorkflow",{serviceId:this.serviceId,workflow:{workflow_name:this.workflowName,workflow_url:this.workflowUrl,workflow_type:this.workflowType,workflow_type_version:this.workflowVersion,workflow_attachment:(null===(t=null===(e=this.runLog)||void 0===e?void 0:e.request)||void 0===t?void 0:t.workflow_attachment)||[]},preRegistered:!1}).then((function(e){o.$store.dispatch("services/addWorkflowId",{serviceId:o.serviceId,workflowId:e}),o.$store.dispatch("runs/addRun",{serviceId:o.serviceId,workflowId:e,runId:o.runId,runName:o.runName,runLog:o.runLog})})),this.$router.push({path:"/runs",query:{runId:this.runId}})}}}},B=n.a.extend(L),z=(o(562),o(458)),H=Object(h.a)(B,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"900"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Import Run")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2"},[o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.runId.length,rules:e.runIdRules,hint:"Enter the Run ID included in this WES service",label:"Run ID",placeholder:"Enter the Run ID"},on:{input:e.changeRunId},model:{value:e.runId,callback:function(t){e.runId=t},expression:"runId"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Run Name",readonly:""},model:{value:e.runName,callback:function(t){e.runName=t},expression:"runName"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Workflow Name",readonly:""},model:{value:e.workflowName,callback:function(t){e.workflowName=t},expression:"workflowName"}}),e._v(" "),o("div",{staticClass:"d-flex"},[e.getFailed?e._e():o("v-text-field",{staticClass:"my-0 mr-auto",style:{maxWidth:"48%",minWidth:"48%"},attrs:{label:"Workflow Type",readonly:""},model:{value:e.workflowType,callback:function(t){e.workflowType=t},expression:"workflowType"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",style:{maxWidth:"48%",minWidth:"48%"},attrs:{label:"Workflow Version",readonly:""},model:{value:e.workflowVersion,callback:function(t){e.workflowVersion=t},expression:"workflowVersion"}})],1),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Workflow URL",readonly:""},model:{value:e.workflowUrl,callback:function(t){e.workflowUrl=t},expression:"workflowUrl"}}),e._v(" "),e.getFailed?e._e():o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.workflowContent),readOnly:"nocursor"}},model:{value:e.workflowContent,callback:function(t){e.workflowContent=t},expression:"workflowContent"}})],1),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 pb-6 mt-4"},[o("v-btn",{attrs:{disabled:!e.formValid,color:"primary",outlined:""},on:{click:function(t){return t.stopPropagation(),e.importRun.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("import")}})],1)],1)])],1)}),[],!1,null,"8166adb2",null),J=H.exports;k()(H,{VBtn:x.a,VCard:_.a,VDialog:O.a,VIcon:T.a,VTextField:z.a});var Y={components:{RunDeleteDialog:j,RunImportDialog:J},props:{serviceId:{type:String,required:!0}},data:function(){return{runHeaders:[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"runName",sortable:!0},{text:"Workflow",value:"workflowName",sortable:!0},{text:"Added Date",value:"addedDate",sortable:!0},{text:"",value:"state",sortable:!1},{text:"",value:"delete",sortable:!1,align:"center",width:"64px"}],selectedRuns:[],importDialogShow:!1,deleteDialogShow:!1,filterType:"",filterWfName:"",filterRunName:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},runsTableItems:function(){return this.$store.getters["runs/tableItems"](this.service.runIds)},filteredItems:function(){var e=this;return this.runsTableItems.filter((function(t){return(!e.filterType||t.workflowType===e.filterType)&&(!(e.filterWfName&&!t.workflowName.includes(e.filterWfName))&&!(e.filterRunName&&!t.runName.includes(e.filterRunName)))}))},workflowTypes:function(){return Array.from(new Set(this.runsTableItems.map((function(e){return e.workflowType}))))}},methods:{reloadRunState:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("runs/updateAllRunsStateByService",e.service.id);case 2:case"end":return t.stop()}}),t)})))()}}},G=n.a.extend(Y),K=(o(564),o(479)),Q=Object(h.a)(G,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{attrs:{"max-width":"1200"}},[r("div",{staticClass:"d-flex align-center mx-6 pt-4"},[r("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-chart-box-outline")}}),e._v(" "),r("div",{staticClass:"card-header",domProps:{textContent:e._s("Runs")}}),e._v(" "),r("v-spacer"),e._v(" "),e.runsTableItems.length?r("v-select",{staticClass:"mt-2 mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{items:e.workflowTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}):e._e(),e._v(" "),e.runsTableItems.length?r("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Run Name","single-line":""},model:{value:e.filterRunName,callback:function(t){e.filterRunName=t},expression:"filterRunName"}}):e._e(),e._v(" "),e.runsTableItems.length?r("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Workflow Name","single-line":""},model:{value:e.filterWfName,callback:function(t){e.filterWfName=t},expression:"filterWfName"}}):e._e(),e._v(" "),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[r("v-btn",e._g({attrs:{color:e.$colors.grey.darken2,disabled:!e.runsTableItems.length,outlined:"",small:""},on:{click:function(t){return t.stopPropagation(),e.reloadRunState.apply(null,arguments)}}},o),[r("v-icon",{domProps:{textContent:e._s("mdi-reload")}})],1)]}}])},[e._v(" "),r("span",{domProps:{textContent:e._s("Reload run status")}})])],1),e._v(" "),e.runsTableItems.length?e._e():r("div",{staticClass:"mx-12 my-2"},[r("span",{style:{fontSize:"1rem",color:e.$colors.grey.darken4},domProps:{textContent:e._s("Executed runs will show up here.")}})]),e._v(" "),e.runsTableItems.length?r("v-data-table",{staticClass:"mx-12 my-2 run-table",attrs:{headers:e.runHeaders,"items-per-page":Number(10),items:e.filteredItems,"item-key":"runId"},scopedSlots:e._u([{key:"item.workflowType",fn:function(t){var n=t.item;return[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var l=t.on;return["cwl"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(420),height:"26"}},l)):"wdl"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(421),height:"26"}},l)):"nextflow"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(422),height:"26"}},l)):"snakemake"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(423),height:"26"}},l)):r("v-icon",e._g({staticClass:"my-2 mr-2",domProps:{textContent:e._s("mdi-graph-outline")}},l))]}}],null,!0)},[e._v(" "),r("span",{domProps:{textContent:e._s(n.workflowType+" "+n.workflowVersion)}})])]}},{key:"item.runName",fn:function(t){var o=t.item;return[r("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/runs",query:{runId:o.runId}}},domProps:{textContent:e._s(o.runName)}})]}},{key:"item.workflowName",fn:function(t){var o=t.item;return[r("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/workflows",query:{workflowId:o.workflowId}}},domProps:{textContent:e._s(o.workflowName)}})]}},{key:"item.state",fn:function(t){var o=t.item;return[r("v-chip",{attrs:{color:o.stateColor,"text-color":"white"},domProps:{textContent:e._s(o.state)}})]}},{key:"item.delete",fn:function(t){var o=t.item;return[r("v-icon",{attrs:{color:e.$colors.grey.darken2},domProps:{textContent:e._s("mdi-trash-can-outline")},on:{click:function(t){t.stopPropagation(),e.selectedRuns=[o],e.deleteDialogShow=!0}}})]}}],null,!0)}):e._e(),e._v(" "),r("div",{staticClass:"d-flex justify-end pb-6 mr-12 mt-2"},[r("v-btn",{attrs:{color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.importDialogShow=!0}}},[r("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),r("span",{domProps:{textContent:e._s("Import")}})],1)],1),e._v(" "),r("run-import-dialog",{attrs:{"dialog-show":e.importDialogShow,"service-id":e.serviceId},on:{close:function(t){e.importDialogShow=!1}}}),e._v(" "),r("run-delete-dialog",{attrs:{"dialog-show":e.deleteDialogShow,"selected-items":e.selectedRuns},on:{close:function(t){e.deleteDialogShow=!1,e.selectedRuns=[]}}})],1)}),[],!1,null,"77921992",null),X=Q.exports;k()(Q,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VIcon:T.a,VSelect:K.a,VSpacer:S.a,VTextField:z.a,VTooltip:V.a});var Z={props:{dialogShow:{type:Boolean,default:!1,required:!0},selectedItems:{type:Array,default:[],required:!0}},methods:{deleteSelectedItems:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("workflows/deleteWorkflows",{workflowIds:e.selectedItems.map((function(e){return e.workflowId}))});case 2:e.$emit("close");case 3:case"end":return t.stop()}}),t)})))()}}},ee=n.a.extend(Z),te=Object(h.a)(ee,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"600"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Remove Workflow")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("The following workflow will be removed:")}}),e._v(" "),o("ul",{style:{paddingLeft:"96px",paddingRight:"96px"}},e._l(e.selectedItems,(function(t,i){return o("li",{key:i,domProps:{textContent:e._s(t.workflowName)}})})),0),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("Runs associated with this workflow will also be removed.")}}),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 mt-4 pb-6"},[o("v-btn",{attrs:{color:"error",outlined:""},on:{click:function(t){return t.stopPropagation(),e.deleteSelectedItems.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Remove")}})],1),e._v(" "),o("v-btn",{staticClass:"ml-4",attrs:{color:"info",outlined:""},on:{click:function(t){return t.stopPropagation(),e.$emit("close")}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-close")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Cancel")}})],1)],1)])],1)}),[],!1,null,null,null),oe=te.exports;k()(te,{VBtn:x.a,VCard:_.a,VDialog:O.a,VIcon:T.a});o(155);function re(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ne(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var ie=[],se={components:{codemirror:f.codemirror},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{name:"",type:"",version:"",locationMode:"download",url:"",fetchFailed:!1,wfContentDownload:"",attachAsFile:!1,wfContentUpload:"",fileName:"",submitButton:!0}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},wfNames:function(){return this.$store.getters["workflows/workflowsByIds"](this.service.workflowIds).map((function(e){return e.name}))},types:function(){var e=this.$store.getters["services/workflowLanguages"](this.serviceId),t=e.map((function(e){return e.name}));return 1===t.length&&(this.type=t[0]),e.map((function(e){return e.name}))},versions:function(){var e,t=re(this.$store.getters["services/workflowLanguages"](this.serviceId));try{for(t.s();!(e=t.n()).done;){var o=e.value;if(o.name===this.type){var r=o.versions;return 1===r.length&&(this.version=r[0]),r}}}catch(e){t.e(e)}finally{t.f()}return[]},registerValid:function(){var content="download"===this.locationMode?!!this.wfContentDownload.length:!!this.wfContentUpload.length;return!this.nameRules.length&&!this.typeRules.length&&!this.versionRules.length&&!this.urlRules.length&&!this.fileNameRules.length&&content},nameRules:function(){return this.name?this.wfNames.includes(this.name)?["Typed name already exists"]:[]:["Required"]},typeRules:function(){return this.type?[]:["Required"]},versionRules:function(){return this.version?[]:["Required"]},urlRules:function(){if("download"===this.locationMode){if(!this.url)return["Required"];if(!Object(m.e)(this.url))return["Invalid URL"];if(this.fetchFailed)return["Failed to get the workflow content from the entered URL"]}return[]},fileNameRules:function(){return"upload"!==this.locationMode||this.fileName?[]:["Required"]}},methods:{changeType:function(){this.type&&1===this.versions.length?this.version=this.versions[0]:this.version=""},changeUrl:function(){for(var e=this;ie.length;){var t=ie.shift();t&&clearTimeout(t)}var o=setTimeout((function(t){e.fetchWfContent(t)}),1e3,this.url);ie.push(o)},fetchWfContent:function(e){var t=this;Object(m.e)(e)?Object(m.b)(this.url).then((function(e){t.url=e,fetch(t.url).then((function(e){e.ok?e.text().then((function(content){t.fetchFailed=!1,t.wfContentDownload=content})):(t.fetchFailed=!0,t.wfContentDownload="")})).catch((function(e){t.fetchFailed=!0,t.wfContentDownload=""}))})):this.wfContentDownload=""},setDragFileName:function(e){var t,o,r,n;(null===(r=null===(o=null===(t=null==e?void 0:e.dataTransfer)||void 0===t?void 0:t.files)||void 0===o?void 0:o[0])||void 0===r?void 0:r.name)&&(this.fileName=null===(n=null==e?void 0:e.dataTransfer)||void 0===n?void 0:n.files[0].name)},submitWorkflow:function(){var e=this;if(this.registerValid){this.submitButton=!1;var t="";if("download"===this.locationMode)if(this.attachAsFile)t=new URL(this.url).pathname.split("/").pop()||this.url;else t=this.url;else t=this.fileName;this.$store.dispatch("workflows/submitWorkflow",{serviceId:this.serviceId,name:this.name,type:this.type,version:this.version,url:t,content:"download"===this.locationMode?this.wfContentDownload:this.wfContentUpload,preRegistered:!1}).then((function(t){e.$emit("close"),e.$router.push({path:"/workflows",query:{workflowId:t}})}))}},codeMirrorMode:function(content){return Object(m.a)(content)}}},ae=n.a.extend(se),le=(o(566),o(598)),ce=o(572),de=Object(h.a)(ae,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"900"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Add Workflow")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2"},[o("v-text-field",{attrs:{"persistent-hint":!e.name.length,rules:e.nameRules,hint:"Name of the workflow (free text, e.g., 'Test workflow,' etc.)",label:"Name",placeholder:"Type a name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),o("v-select",{attrs:{items:e.types,"persistent-hint":!e.type.length,rule:e.typeRules,hint:"Select the workflow langauge type",label:"Type"},on:{change:e.changeType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),e._v(" "),o("v-select",{attrs:{disabled:!e.type,items:e.versions,"persistent-hint":!e.type.length,rules:e.versionRules,hint:"Select the workflow langauge version",label:"Version"},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}})],1),e._v(" "),o("div",{staticClass:"mx-12 mt-2"},[o("div",{staticClass:"d-flex align-center"},[o("span",{style:{color:""+e.$colors.grey.darken2},domProps:{textContent:e._s("Document")}}),e._v(" "),o("v-chip-group",{staticClass:"ml-6",attrs:{mandatory:"",color:"primary"},model:{value:e.locationMode,callback:function(t){e.locationMode=t},expression:"locationMode"}},[o("v-chip",{attrs:{value:"download",label:"",outlined:""}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-download-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Fetch")}})],1),e._v(" "),o("v-chip",{attrs:{value:"upload",label:"",outlined:""}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-upload-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Upload")}})],1)],1)],1),e._v(" "),"download"===e.locationMode?o("div",{staticClass:"ml-4 d-flex flex-column"},[o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.url.length,rules:e.urlRules,hint:"Network reachable location of the workflow document",label:"URL",placeholder:"Type a URL"},on:{input:e.changeUrl},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),e._v(" "),e.wfContentDownload.length?o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.wfContentDownload),readOnly:"nocursor"}},model:{value:e.wfContentDownload,callback:function(t){e.wfContentDownload=t},expression:"wfContentDownload"}}):e._e()],1):"upload"===e.locationMode?o("div",{staticClass:"ml-4 d-flex flex-column"},[e.wfContentUpload.length?e._e():o("div",{staticClass:"mb-2"},[o("span",{style:{color:""+e.$colors.grey.darken2,fontSize:"0.9rem"},domProps:{textContent:e._s("Drag-and-Drop or Copy-and-Paste the document into the box below.")}})]),e._v(" "),e.wfContentUpload.length?o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.fileName.length,rules:e.fileNameRules,hint:"The name of workflow document when it is placed in the execution directory and passed to the workflow engine",label:"File Name",placeholder:"Type a file name"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}):e._e(),e._v(" "),o("div",{on:{drop:e.setDragFileName}},[o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.wfContentUpload),readOnly:!1}},model:{value:e.wfContentUpload,callback:function(t){e.wfContentUpload=t},expression:"wfContentUpload"}})],1)],1):e._e()]),e._v(" "),o("div",{staticClass:"d-flex justify-end align-center mx-12 pb-6 mt-4"},["download"===e.locationMode&&e.wfContentDownload.length?o("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("div",e._g({staticClass:"mr-6"},r),[o("v-checkbox",{staticClass:"ma-0 pa-0",attrs:{"hide-details":"",label:"Attach as File"},model:{value:e.attachAsFile,callback:function(t){e.attachAsFile=t},expression:"attachAsFile"}})],1)]}}],null,!1,596384175)},[e._v(" "),o("span",{domProps:{textContent:e._s("Check this box if you want to place the workflow document in the execution directory and pass it as a local path, instead of passing the remote URL directly to the workflow engine.")}})]):e._e(),e._v(" "),o("v-btn",{attrs:{disabled:!(e.registerValid&&e.submitButton),color:"primary",outlined:""},on:{click:function(t){return t.stopPropagation(),e.submitWorkflow.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-arrow-up")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Submit")}})],1)],1)])],1)}),[],!1,null,"e04e3864",null),ue=de.exports;k()(de,{VBtn:x.a,VCard:_.a,VCheckbox:le.a,VChip:C.a,VChipGroup:ce.a,VDialog:O.a,VIcon:T.a,VSelect:K.a,VTextField:z.a,VTooltip:V.a});o(70),o(59),o(197);var fe=o(123);function pe(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return me(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var ve=[],we={components:{AppBar:l.a,AppFooter:c.a},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{trsEndpoint:"https://workflowhub.eu/ga4gh/trs/v2",fetchFailed:!1,serviceInfo:null,tools:[],tableHeaders:[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"workflowNameVal",sortable:!0},{text:"Organization",value:"organization",sortable:!0},{text:"Workflow URL",value:"workflowUrl",sortable:!1},{text:"",value:"importButton",sortable:!1}],filterType:null,filterWorklfowName:"",filterOrganization:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},wfLangs:function(){return this.$store.getters["services/workflowLanguages"](this.serviceId)},wfTypes:function(){return this.wfLangs.map((function(e){return e.name}))},trsEndpointRules:function(){if(!this.trsEndpoint)return["Required"];if(!Object(m.e)(this.trsEndpoint))return["Invalid URL"];if(this.fetchFailed)return["Failed to fetch TRS response from the endpoint"];if(this.serviceInfo){if("trs"!==this.serviceInfo.type.artifact)return["Not a TRS endpoint"];if(!this.serviceInfo.type.version.startsWith("2"))return["Not a TRS v2 endpoint"]}return[]},tableContents:function(){var e,t=[],o=pe(this.tools);try{for(o.s();!(e=o.n()).done;){var r,n=e.value,l=pe(n.versions);try{for(l.s();!(r=l.n()).done;){var c=r.value;if(c.descriptor_type){var d,f=pe(c.descriptor_type);try{for(f.s();!(d=f.n()).done;){var m=d.value,v={id:n.id,version:c.id,idVersionType:"".concat(n.id,"-").concat(c.id,"-").concat(m),workflowType:Object(fe.a)(m),workflowName:n.name?"".concat(n.name):"".concat(n.id,"-").concat(m),workflowNameVal:n.name?"".concat(n.name,"-").concat(c.id):"".concat(n.id,"-").concat(m,"-").concat(c.id),workflowVersion:c.id,organization:n.organization,workflowUrl:c.url,importButton:""};this.filterType&&v.workflowType!==this.filterType||v.workflowName.includes(this.filterWorklfowName)&&v.organization.includes(this.filterOrganization)&&t.push(v)}}catch(e){f.e(e)}finally{f.f()}}}}catch(e){l.e(e)}finally{l.f()}}}catch(e){o.e(e)}finally{o.f()}return t}},methods:{changeTrsEndpoint:function(e){for(var t=this;ve.length;){var o=ve.shift();o&&clearTimeout(o)}var r=setTimeout((function(e){t.fetchTrs(e)}),500,this.trsEndpoint);ve.push(r)},fetchTrs:function(e){var t=this;Object(m.e)(e)&&(this.trsEndpoint=e.replace(/\/$/,""),Object(fe.e)(this.trsEndpoint).then((function(e){if(t.fetchFailed=!1,t.serviceInfo=e,"trs"===t.serviceInfo.type.artifact&&t.serviceInfo.type.version.startsWith("2")){var o,r=pe(t.wfTypes);try{for(r.s();!(o=r.n()).done;){var n=o.value;fe.h.includes(n)&&Object(fe.f)(t.trsEndpoint,n).then((function(e){t.tools=t.tools.concat(e)}))}}catch(e){r.e(e)}finally{r.f()}}})).catch((function(){t.fetchFailed=!0,t.serviceInfo=null,t.tools=[]})))},importWorkflow:function(e){var t=this,o=this.wfLangs.find((function(t){return t.name===e.workflowType}));this.$store.dispatch("workflows/importWorkflowFromTrs",{serviceId:this.serviceId,trsEndpoint:this.trsEndpoint,trsWorkflowId:e.id,trsWorkflowVersion:e.version,trsWorkflowType:e.workflowType,trsWorkflowName:e.workflowNameVal,workflowVersion:(null==o?void 0:o.versions[0])||""}).then((function(e){t.$emit("close"),t.$router.push({path:"/workflows",query:{workflowId:e}})}))}},mounted:function(){this.fetchTrs(this.trsEndpoint)}},he=n.a.extend(we),ge=Object(h.a)(he,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"1200"},on:{"click:outside":function(t){return e.$emit("close")}}},[r("v-card",{staticClass:"pb-4"},[r("div",{staticClass:"d-flex align-center mx-6 pt-4"},[r("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-application-import")}}),e._v(" "),r("div",{staticClass:"card-header",domProps:{textContent:e._s("Import Workflow from TRS")}})],1),e._v(" "),r("div",{staticClass:"mx-12 my-2"},[r("v-text-field",{attrs:{"persistent-hint":!e.trsEndpoint.length,rules:e.trsEndpointRules,hint:"Endpoint of the TRS (e.g., 'https://workflowhub.eu/ga4gh/trs/v2' etc.)",label:"TRS Endpoint",placeholder:"Type a TRS endpoint"},on:{input:e.changeTrsEndpoint},model:{value:e.trsEndpoint,callback:function(t){e.trsEndpoint=t},expression:"trsEndpoint"}})],1),e._v(" "),e.tableContents.length?r("div",{staticClass:"d-flex mx-12"},[r("v-spacer"),e._v(" "),r("v-select",{staticClass:"mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{items:e.wfTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}),e._v(" "),r("v-text-field",{staticClass:"mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Name","single-line":""},model:{value:e.filterWorklfowName,callback:function(t){e.filterWorklfowName=t},expression:"filterWorklfowName"}}),e._v(" "),r("v-text-field",{style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Organization","single-line":""},model:{value:e.filterOrganization,callback:function(t){e.filterOrganization=t},expression:"filterOrganization"}})],1):e._e(),e._v(" "),e.tableContents.length?r("v-data-table",{staticClass:"mx-12 my-2 workflow-table",attrs:{headers:e.tableHeaders,"items-per-page":Number(10),items:e.tableContents,"item-key":"idVersionType"},scopedSlots:e._u([{key:"item.workflowType",fn:function(t){var n=t.item;return["CWL"===n.workflowType?r("img",{staticClass:"mt-2 mr-2",attrs:{src:o(420),height:"26"}}):"WDL"===n.workflowType?r("img",{staticClass:"mt-2 mr-2",attrs:{src:o(421),height:"26"}}):"Nextflow"===n.workflowType?r("img",{staticClass:"mt-2 mr-2",attrs:{src:o(422),height:"26"}}):"Snakemake"===n.workflowType?r("img",{staticClass:"mt-2 mr-2",attrs:{src:o(423),height:"26"}}):r("v-icon",{staticClass:"my-2 mr-2",domProps:{textContent:e._s("mdi-graph-outline")}})]}},{key:"item.workflowNameVal",fn:function(t){var o=t.item;return[r("span",[e._v("\n          "+e._s(o.workflowName)+"\n          "),r("v-chip",{staticClass:"ml-4",attrs:{color:e.$colors.indigo.lighten2,"text-color":"white",small:""},domProps:{textContent:e._s("ver. "+o.workflowVersion)}})],1)]}},{key:"item.workflowUrl",fn:function(t){var o=t.item;return[r("a",{attrs:{href:o.workflowUrl},domProps:{textContent:e._s(o.workflowUrl)}})]}},{key:"item.importButton",fn:function(t){var o=t.item;return[r("v-btn",{staticClass:"text-capitalize",attrs:{color:"primary",outlined:"",small:""},domProps:{textContent:e._s("Import")},on:{click:function(t){return t.stopPropagation(),e.importWorkflow(o)}}})]}}],null,!0)}):e._e()],1)],1)}),[],!1,null,null,null),ye=ge.exports;k()(ge,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VDialog:O.a,VIcon:T.a,VSelect:K.a,VSpacer:S.a,VTextField:z.a});var ke={components:{WorkflowDeleteDialog:oe,WorkflowRegisterDialog:ue,WorkflowTrsImportDialog:ye},props:{serviceId:{type:String,required:!0}},data:function(){return{workflowHeaders:[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"workflowName",sortable:!0},{text:"Added / Updated Date",value:"date",sortable:!0},{text:"",value:"delete",sortable:!1,align:"center",width:"64px"}],selectedWorkflows:[],registerDialogShow:!1,importDialogShow:!1,deleteDialogShow:!1,filterType:"",filterName:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},workflowTableItems:function(){return this.$store.getters["workflows/tableItems"](this.service.workflowIds)},filteredItems:function(){var e=this;return this.workflowTableItems.filter((function(t){return(!e.filterType||t.workflowType===e.filterType)&&!(e.filterName&&!t.workflowName.includes(e.filterName))}))},registeredOnlyMode:function(){return this.$store.getters["services/registeredOnlyMode"](this.serviceId)},workflowTypes:function(){return Array.from(new Set(this.workflowTableItems.map((function(e){return e.workflowType}))))}}},xe=n.a.extend(ke),_e=(o(573),Object(h.a)(xe,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{attrs:{"max-width":"1200"}},[r("div",{staticClass:"d-flex align-center mx-6 pt-4"},[r("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-graph-outline")}}),e._v(" "),r("div",{staticClass:"card-header",domProps:{textContent:e._s("Workflows")}}),e._v(" "),r("v-spacer"),e._v(" "),e.workflowTableItems.length?r("v-select",{staticClass:"mt-2 mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{items:e.workflowTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}):e._e(),e._v(" "),e.workflowTableItems.length?r("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Name","single-line":""},model:{value:e.filterName,callback:function(t){e.filterName=t},expression:"filterName"}}):e._e()],1),e._v(" "),e.workflowTableItems.length?e._e():r("div",{staticClass:"mx-12 my-2"},[r("span",{style:{color:e.$vuetify.theme.themes.light.error,textDecorationLine:"underline",fontSize:"1rem"},domProps:{textContent:e._s("Add workflow to start composing a run.")}})]),e._v(" "),e.workflowTableItems.length?r("v-data-table",{staticClass:"mx-12 my-2 workflow-table",attrs:{headers:e.workflowHeaders,"items-per-page":Number(10),items:e.filteredItems,"item-key":"workflowId"},scopedSlots:e._u([{key:"item.workflowType",fn:function(t){var n=t.item;return[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var l=t.on;return["cwl"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(420),height:"26"}},l)):"wdl"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(421),height:"26"}},l)):"nextflow"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(422),height:"26"}},l)):"snakemake"===n.workflowType.toLowerCase()?r("img",e._g({staticClass:"mt-2 mr-2",attrs:{src:o(423),height:"26"}},l)):r("v-icon",e._g({staticClass:"my-2 mr-2",domProps:{textContent:e._s("mdi-graph-outline")}},l))]}}],null,!0)},[e._v(" "),r("span",{domProps:{textContent:e._s(n.workflowType+" "+n.workflowVersion)}})])]}},{key:"item.workflowName",fn:function(t){var o=t.item;return[r("div",{staticClass:"d-flex"},[r("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/workflows",query:{workflowId:o.workflowId}}},domProps:{textContent:e._s(o.workflowName)}}),e._v(" "),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[o.preRegistered?r("v-icon",e._g({staticClass:"ml-2",attrs:{color:e.$colors.indigo.darken1,small:""},domProps:{textContent:e._s("mdi-account-check-outline")}},n)):e._e()]}}],null,!0)},[e._v(" "),r("span",{domProps:{textContent:e._s("Pre-registered workflow")}})])],1)]}},{key:"item.delete",fn:function(t){var o=t.item;return[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("div",e._g({},o.preRegistered&&n),[r("v-icon",{attrs:{disabled:o.preRegistered,color:e.$colors.grey.darken2},domProps:{textContent:e._s("mdi-trash-can-outline")},on:{click:function(t){t.stopPropagation(),e.selectedWorkflows=[o],e.deleteDialogShow=!0}}})],1)]}}],null,!0)},[e._v(" "),r("span",{domProps:{textContent:e._s("This workflow is pre-registered and cannot be removed.")}})])]}}],null,!0)}):e._e(),e._v(" "),r("div",{staticClass:"d-flex justify-end pb-6 mr-12 mt-2"},[r("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[r("v-btn",e._g({attrs:{disabled:e.registeredOnlyMode,color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.registerDialogShow=!0}}},e.registeredOnlyMode&&o),[r("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),r("span",{domProps:{textContent:e._s("Add")}})],1)]}}])},[e._v(" "),r("span",{domProps:{textContent:e._s("This WES service operates in the mode of pre-registering workflows. Would you please ask your administrator to add workflows?")}})]),e._v(" "),r("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[r("v-btn",e._g({staticClass:"ml-4",attrs:{disabled:e.registeredOnlyMode,color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.importDialogShow=!0}}},e.registeredOnlyMode&&o),[r("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-application-import")}}),e._v(" "),r("span",{domProps:{textContent:e._s("Import")}})],1)]}}])},[e._v(" "),r("span",{domProps:{textContent:e._s("This WES service operates in the mode of pre-registering workflows. Would you please ask your administrator to import workflows?")}})])],1),e._v(" "),r("workflow-register-dialog",{attrs:{"dialog-show":e.registerDialogShow,"service-id":e.serviceId},on:{close:function(t){e.registerDialogShow=!1}}}),e._v(" "),r("workflow-delete-dialog",{attrs:{"dialog-show":e.deleteDialogShow,"selected-items":e.selectedWorkflows},on:{close:function(t){e.deleteDialogShow=!1,e.selectedWorkflow=[]}}}),e._v(" "),r("workflow-trs-import-dialog",{attrs:{"dialog-show":e.importDialogShow,"service-id":e.serviceId},on:{close:function(t){e.importDialogShow=!1}}})],1)}),[],!1,null,"6b060a16",null)),be=_e.exports;k()(_e,{VBtn:x.a,VCard:_.a,VDataTable:I.a,VIcon:T.a,VSelect:K.a,VSpacer:S.a,VTextField:z.a,VTooltip:V.a});var Ce={components:{AppBar:l.a,AppFooter:c.a,Breadcrumbs:d.a,InfoCard:$,RunCard:X,WorkflowCard:be},middleware:function(e){var t=e.store,o=e.route.query.serviceId||"";Array.isArray(o)&&(o=o[0]||""),window.onNuxtReady(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dispatch("services/updateService",o);case 2:return e.next=4,t.dispatch("runs/updateAllRunsStateByService",o);case 4:case"end":return e.stop()}}),e)}))))},computed:{existServiceId:function(){return this.$store.getters["services/serviceIds"].includes(this.serviceId)},serviceId:function(){var e=this.$route.query.serviceId||"";return Array.isArray(e)?e[0]||"":e}}},Ie=n.a.extend(Ce),Te=o(406),Se=o(410),Ne=o(408),Re=Object(h.a)(Ie,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-app",[o("app-bar"),e._v(" "),o("v-main",{staticClass:"background"},[o("v-container",{attrs:{fluid:""}},[o("breadcrumbs"),e._v(" "),e.existServiceId?[o("info-card",{staticClass:"mx-auto",attrs:{"service-id":e.serviceId}}),e._v(" "),o("workflow-card",{staticClass:"mt-8 mx-auto",attrs:{"service-id":e.serviceId}}),e._v(" "),o("run-card",{staticClass:"mt-8 mx-auto mb-4",attrs:{"service-id":e.serviceId}})]:[e._v(e._s("Service id: "+e.serviceId+" does not exist."))]],2)],1),e._v(" "),o("app-footer")],1)}),[],!1,null,null,null);t.default=Re.exports;k()(Re,{VApp:Te.a,VContainer:Se.a,VMain:Ne.a})}}]);